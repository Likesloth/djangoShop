{% extends 'myapp/base.html' %}
{% load static %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/myCss.css' %}">
{% endblock head_extra %}

{% block myheader %}
    <h1 class="text-3xl sm:text-4xl font-bold text-center">CoC Gaming Shop</h1>
    {% if user.is_authenticated %}
      {% with t=user.profile.usertype|default:"" %}
        {% if t|lower == 'vvip' %}
          <p class="text-center text-green-700 mt-2">15% Discount for VVIP members</p>
        {% elif t|lower == 'vip' %}
          <p class="text-center text-green-700 mt-2">10% Discount for VIP members</p>
        {% elif t|lower == 'member' %}
          <p class="text-center text-green-700 mt-2">5% Discount for members</p>
        {% endif %}
      {% endwith %}
    {% endif %}
{% endblock myheader %}

{% block content %}
<div class="container py-5">
  <div class="row g-4">
    {% for product in allproduct %}
      <div class="col-12 col-sm-6 col-lg-4 d-flex">
        <div class="card shadow-sm w-100">
          {% if product.picture %}
            <img src="{{ product.picture.url }}" alt="{{ product.title }}" class="card-img-top" style="height: 220px; object-fit: cover;">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ product.title }}</h5>
            <p class="card-text text-muted">{{ product.description }}</p>
            <p class="fw-semibold mb-1">GHC {{ product.price }}</p>
            <p class="text-secondary small">Stock: {{ product.quantity }}</p>
            {% if product.specfile %}
              <a href="{{ product.specfile.url }}" class="btn btn-primary btn-sm mt-auto align-self-start" download>more detail</a>
            {% else %}
              <span class="btn btn-sm btn-outline-secondary disabled mt-auto align-self-start">more detail</span>
            {% endif %}
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12 text-center text-muted">No products available.</div>
    {% endfor %}
  </div>

  <nav aria-label="Product pagination" class="mt-4">
    <ul class="pagination justify-content-center">
      <li class="page-item {% if not allproduct.has_previous %}disabled{% endif %}">
        <a class="page-link" href="{% if allproduct.has_previous %}?page={{ allproduct.previous_page_number }}{% else %}#{% endif %}" tabindex="{% if allproduct.has_previous %}0{% else %}-1{% endif %}">Previous</a>
      </li>
      <li class="page-item active" aria-current="page">
        <span class="page-link">{{ allproduct.number }}</span>
      </li>
      <li class="page-item {% if not allproduct.has_next %}disabled{% endif %}">
        <a class="page-link" href="{% if allproduct.has_next %}?page={{ allproduct.next_page_number }}{% else %}#{% endif %}" tabindex="{% if allproduct.has_next %}0{% else %}-1{% endif %}">Next</a>
      </li>
    </ul>
  </nav>
</div>
{% endblock content %}
