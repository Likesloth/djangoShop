{% extends 'myapp/layout/base.html' %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-6">
  <!-- Header -->
  <div class="mb-6 flex items-center justify-between">
    <h2 class="text-3xl font-bold text-gray-800">Fines Ledger</h2>
    <a class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl border-2 border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400 font-semibold transition-all hover:scale-105"
       href="{% url 'report-fines-summary-csv' %}">
      Fines Summary CSV
    </a>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Unpaid -->
    <div class="bg-white/90 backdrop-blur-xl rounded-3xl border-2 border-gray-100 shadow-xl overflow-hidden">
      <div class="px-6 py-4 bg-gradient-to-r from-amber-500/15 via-orange-500/15 to-red-500/15 border-b-2 border-gray-100">
        <h3 class="text-lg font-bold text-gray-800">Unpaid</h3>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full">
          <thead>
            <tr class="bg-gray-50 border-b-2 border-gray-200">
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Book</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Borrower</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Amount</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Action</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            {% for fine in unpaid %}
              <tr class="hover:bg-amber-50/60">
                <td class="px-6 py-3 text-gray-800 font-medium">{{ fine.loan.copy.book.title }}</td>
                <td class="px-6 py-3 text-gray-700">{{ fine.loan.borrower.username }}</td>
                <td class="px-6 py-3 font-bold text-red-600">${{ fine.amount }}</td>
                <td class="px-6 py-3">
                  <a class="inline-flex items-center justify-center gap-2 px-3 py-2 rounded-xl bg-emerald-600 hover:bg-emerald-500 text-white text-sm font-semibold shadow"
                     href="{% url 'staff-fine-paid' fine.id %}">Mark Paid</a>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4" class="px-6 py-10 text-center text-gray-500">No unpaid fines.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Paid -->
    <div class="bg-white/90 backdrop-blur-xl rounded-3xl border-2 border-gray-100 shadow-xl overflow-hidden">
      <div class="px-6 py-4 bg-gradient-to-r from-emerald-500/15 to-green-500/15 border-b-2 border-gray-100">
        <h3 class="text-lg font-bold text-gray-800">Paid</h3>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full">
          <thead>
            <tr class="bg-gray-50 border-b-2 border-gray-200">
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Book</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Borrower</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Amount</th>
              <th class="text-left px-6 py-3 text-xs font-bold text-gray-600 uppercase tracking-wider">Paid At</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            {% for fine in paid %}
              <tr class="hover:bg-emerald-50/50">
                <td class="px-6 py-3 text-gray-800 font-medium">{{ fine.loan.copy.book.title }}</td>
                <td class="px-6 py-3 text-gray-700">{{ fine.loan.borrower.username }}</td>
                <td class="px-6 py-3 font-semibold text-emerald-700">${{ fine.amount }}</td>
                <td class="px-6 py-3 text-gray-600">{{ fine.paid_at|date:'Y-m-d H:i' }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="4" class="px-6 py-10 text-center text-gray-500">No paid fines.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

